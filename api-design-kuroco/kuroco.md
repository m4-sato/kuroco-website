# Kuroco キャッチアップ

## 管理マニュアル（管理画面構成）

### 1.コンテンツ定義

#### 1-1.コンテンツ定義一覧

- ID:コンテンツ定義ごとに固有の ID が表示されます。
- 公開:コンテンツ定義の公開状態を確認できます。
- タイトル:コンテンツ定義の名前が表示されます。コンテンツ定義の名前をクリックすると編集画面へ移動し、コンテンツ定義の細かな設定を行えます。
- 編集 各画面へ移動します。
- 追加：コンテンツ作成画面へ遷移します。
  - 一覧：コンテンツ定義内のコンテンツを一覧で表示します。
  - **カテゴリ設定：コンテンツ定義に設定したカテゴリを一覧で表示します。**
  - アップロード：CSV による一括アップロードが出来ます。
  - ダウンロード：コンテンツ定義内のコンテンツを CSV で一括ダウンロード出来ます。
- API リクエスト制限:**コンテンツ定義編集でグループを選択している場合は、グループ名が表示されます。**
- 編集制限:**コンテンツ定義編集でグループを選択している場合は、グループ名が表示されます。**
- 所有コンテンツ限定で編集制限：**コンテンツ定義編集でグループを選択している場合は、グループ名が表示されます。**
- 件数:登録済みのコンテンツの件数が表示されます。
- 並び順:並び順を入力します。数値の大きい順に並びます。
- 更新日時：最後にコンテンツを更新した日時が表示されます。

##### 1-1-1 コンテンツ定義編集

- 全般
  - 全般
    - ID:コンテンツ定義のグループ ID を表示します。
      ID は自動で採番されます。
    - 名前:コンテンツ定義のグループ名を入力します。
    - 説明:コンテンツ定義の説明を入力します。
  - 公開設定
    - 公開にする：コンテンツを公開します。
    - 非公開にする：コンテンツを非公開にします。
    - 公開日指定：開始日付、終了日付を任意に指定してコンテンツを公開します。
- 項目設定
  - **項目名:項目名が表示されます。**
  - **項目設定：項目設定が表示されます。**
    **詳細はコンテンツ定義で利用できる拡張項目一覧を確認。**
  - **Slug/ID：Slug/ID が表示されます。**
  - **入力制限：必須設定の有無が確認できます。**
  - 編集ボタン
    - 全般
    - 入力制限
    - 検索設定
    - カスタムテンプレート
- 詳細設定
  - 並び順(大きい方が上):コンテンツ定義グループ一覧での並び順を入力します。数字が大きい方が上に表示されます。
  - 最大コンテンツ数：最大コンテンツ数を入力します。
    　　※ 無制限にしたい場合：0
    　　※ 一覧ページを作成しない場合：1
  - プレビューの対象とするページの URL：コンテンツ編集でプレビュー表示をした際に表示するページの URL を設定します。
  - 更新履歴を残さない：チェックを入れると更新履歴を残らない代わりに、パフォーマンスが向上します。後から有効化した場合、既存の履歴データは消去されます。
  - コンテンツに設定できるカテゴリ数:コンテンツ編集画面で設定可能なカテゴリの数を指定します。
  - カテゴリツリー表示:コンテンツ編集ページでのカテゴリの表示方法を設定します。
  - カテゴリ拡張設定:サンプルを参考に記述すると、コンテンツカテゴリ編集の入力項目を修正することができます。
  - 選択ボックスにタグを表示する：コンテンツ編集ページでのタグの表示方法を設定します。
  - 非公開タグの設定を許可する:有効にするとコンテンツ編集画面で非公開のタグも設定できるようになります。
  - ドラッグ&ドロップで拡張項目の並び替えを有効にする：有効にすると繰り返しが設定された項目の並び順をドラッグ&ドロップで変更できるようになります。
  - 注意事項：注意事項を入力します。
  - CSS：コンテンツ編集画面の CSS を設定することができます。
    　　　※Smarty が有効になっているので、{ }を使用する場合は、{literal} {/literal}で囲むように記述します。
  - JavaScript:コンテンツ編集画面の JS を設定することができます。
- 権限設定
  - API リクエスト制限：対象のグループに属するメンバーだけがコンテンツのレスポンスを得られるようになります。
  - 編集制限：当該コンテンツ定義を編集できるグループを選択します。編集を「許可する」設定です。
  - 所有コンテンツ限定で編集制限：自分が作成したコンテンツのみ編集できます。権限を与えたいグループを選択します。
    　　編集を「制限する」設定です。
  - 要申請グループ：コンテンツ編集時、申請が必要になるグループを設定します。
    　　ただし、グループ権限設定の「管理者」にチェックがあると、申請不要になります。
    　　編集を「制限する」設定です。
  - 申請権限での非公開・下書き保存許可 多言語設定をしているサイトにのみ表示されます。
    副言語のコンテンツを投稿するには、まず主言語のコンテンツを作成する必要がありますが、許可を出すことで、ワークフローの利用が必須のグループでも非公開であれば主言語のコンテンツを作成することができます。
- 一括設定
  - ファイル
  - JSON
- 検索設定
  - キーワード検索にテンプレートを利用する：チェックを入れると full_text_search でこのテンプレートを検索できるようになり検索の柔軟性やパフォーマンスが向上します。
  - キーワードテンプレート：全文検索に用いる文字列を登録します。Smarty を使って必要なコンテンツの内容を出力してください。
    　　詳しい使い方はキーワード検索用文字列を用意するを参照してください。
  - ベクトルデータに変換する：チェックを入れると API の chat の回答に利用されるコンテンツとして登録されたり、ベクトル検索に利用できるようになります。
  - AI によるベクトルデータの最適化：チェックを入れるとベクトルデータを作る際に AI によって最適化やデータの拡張を行います。
  - 埋め込みモデル 埋め込みモデルを選択します。
  - キーワードテンプレート(AI/Vector) OpenAI に参照させたいデータを空白区切りで登録します。Smarty を使って必要なコンテンツの内容を出力してください。改行は自動で空白に置換されます。
  - キーワードテンプレート(AI/Vector)向けの AI 辞書 設定すると、キーワードテンプレートに対して AI 辞書を適用します。

### 1-2. コンテンツカテゴリ

コンテンツ定義 -> カテゴリを確認したいコンテンツ定義のカテゴリ設定を選択

#### 1-2-1. コンテンツカテゴリ一覧

- ダウンロードする：登録されているコンテンツカテゴリ情報をダウンロードします。
- 公開：公開状態を確認できます。
- ID：カテゴリ毎に固有の ID を表示します。
- カテゴリ名：カテゴリ名を表示します。クリックするとカテゴリ編集画面へ遷移します。
- メモ：カテゴリ編集画面で入力したメモが表示されます。
- 並び順：並び順は数字の大きい順に並びます。カテゴリの並び順を入力後［並び順を更新する］をクリックすると、一括で変更することができます。

##### 1-2-1-1. コンテンツカテゴリ編集

コンテンツ定義 -> 編集したいカテゴリの[カテゴリ名]をクリック。

- カテゴリ名：カテゴリ名です。クリックするとカテゴリの編集画面が表示されます。
- Slug：コンテンツカテゴリの Slug を入力します。
- 親カテゴリ：親カテゴリを選択できます。
- 並び順：数字の大きい順に並びます。
- 拡張項目：01〜拡張項目 05 カテゴリの補足説明を入力します。
- API リクエスト制限：API リクエスト制限がかかっているカテゴリが 1 つでもコンテンツに設定されている場合、対象のグループに属するメンバーだけがそのコンテンツをからのレスポンスを得られるようになります。
- 編集制限：カテゴリの編集制限を指定します。選択されたグループのメンバーのみ編集可能になります。
- メモ：用途などを記入しておくと便利です。登録した内容は管理画面のカテゴリ一覧にも表示されます。

##### 1-3.タグカテゴリ

左ブレード[タグ]より、画面左上歯車マーク -> [カテゴリ設定]をクリック。

##### 1-3-1. タグカテゴリ編集

タグカテゴリ一覧ページから編集をしたいタグカテゴリの[カテゴリ名]をクリック

- カテゴリ名 タグのカテゴリを入力します。
- **親カテゴリ** 親カテゴリを選択します。
- 対象 カテゴリが設定されたタグが表示される対象の機能を限定できます。コンテンツ定義 ID を空にした場合は全てのコンテンツが対象になります。対象の設定は子カテゴリに引き継がれます。
- 並び順 数の大きな順に並べ替えできます。
- 編集制限 このカテゴリの編集を制限する・しないを選択します。デフォルトは「制限なし」にチェックがあります。「制限あり」にするときは、編集を許可するグループを選択してください。グループは複数選択できます。

### 2. API

#### 2-1. API のエンドポイント作成

左ブレード[API]より、対象のエンドポイント一覧をクリック。

画面右上「＋ API 構造の追加」を選択

- タイトル：API タイトルを記入(必須)
- 版：バージョンを記入(必須)
- 説明：API に関する説明を記入(必須)
- 並び順:API の並び順を入力します。降順に並びます。
- セキュリティ：API のセキュリティを選択。

#### 2-2. API 　エンドポイントの点検（SwaggerUI）

コンテンツ定義で作成した` グループID``9 `を把握

記事を作成

作成した記事の` トピックスID``8 `を控えておく

エンドポイント一覧画面上部 SwaggerUI をクリック

対象の URI を選択し、Try it out を押下、topics_id に先ほどの topics_id を入力し、execute を押下
[!NOTE]API 実行時　 401 エラー "[GW] Access Token is required"が出た場合画面上部右側の「セキュリティ」-> 設定でセキュリティ設定を変更

#### 2-3. API 仕様書のエクスポート

エンドポイント一覧画面上部の「その他」 -> OpenAPI をエクスポート -> yaml を選択

#### 2-4. API セキュリティ

##### 2-4-1. セキュリティの種類

|                      |                            |                                                                                     |
| -------------------- | -------------------------- | ----------------------------------------------------------------------------------- |
| なし                 | アクセス制限なし           | 一時的な開発用 API を作成してテストする場合、完全にオープンなデータのみ使用する場合 |
| 静的アクセストークン | 静的生成されたトークン認証 | サーバー間通信する場合や公開情報の提供 API などに利用                               |
| 動的アクセストークン | 動的生成されたトークン認証 | ログインが必要なサイトなど                                                          |
| Cookie               | Cookie による認証          | ログインが必要なサイトなどに利用                                                    |

##### 2-4-2. IP アドレス制限

指定された IP アドレスからのアクセスのみ許可

#### 2-5. API 後処理

左ブレード[API]より、対象のエンドポイント一覧をクリック。

対象のエンドポイントの「後処理」を選択

#### 情報源

- [kuroco 管理サイト](https://20250627-kuroco-test.g.kuroco-mng.app/management/menu/menu/)
- [kuroco 管理画面マニュアル](https://kuroco.app/ja/docs/management/dashboard/)
- []
